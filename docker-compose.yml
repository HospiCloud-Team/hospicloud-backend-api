version: '3'
services:
    utilities:
        container_name: utilities
        depends_on: 
            - postgres-db
        build: 
            context: ./
            dockerfile: utilities/Dockerfile
        environment:
            - PORT=8080
        ports:
            - 8080:8080
    checkups:
        container_name: checkups
        depends_on: 
            - postgres-db
        build: 
            context: ./
            dockerfile: checkups/Dockerfile
        environment:
            - PORT=8081
        ports:
            - 8081:8081
    users:
        container_name: users
        depends_on: 
            - postgres-db
        build: 
            context: ./
            dockerfile: users/Dockerfile
        volumes:
          - ${CREDENTIALS_PATH}:/credentials.json
        environment:
            - PORT=8082
            - GOOGLE_APPLICATION_CREDENTIALS=/credentials.json
            - PROJECT_ID=${PROJECT_ID}
        ports:
            - 8082:8082
    postgres-db:
        container_name: postgres-db
        image: postgres:latest
        restart: always
        environment:
            - POSTGRES_USER=root
            - POSTGRES_PASSWORD=password
        ports: 
            - 5432:5432
